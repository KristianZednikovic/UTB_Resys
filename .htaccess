RewriteEngine On

# Handle backend API routes first
RewriteCond %{REQUEST_URI} ^/backend/
RewriteRule ^backend/(.*)$ backend/$1 [L]

# Handle static files from build directory
RewriteCond %{REQUEST_URI} ^/static/
RewriteRule ^(.*)$ frontend/build/$1 [L]

# Handle other static assets (images, fonts, etc.)
RewriteCond %{REQUEST_URI} \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|map)$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ frontend/build/$1 [L]

# Handle React Router - serve index.html for all non-API routes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/backend/
RewriteRule ^(.*)$ frontend/build/index.html [L]
